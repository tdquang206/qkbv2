{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <h2>Edit Kid Info</h2>
    <form method="post" id="kid-form" action="{{ url_for('edit_kid', kid_id=kid.id) }}">
        <div class="mb-3">
            <label for="name" class="form-label">Kid name</label>
            <input type="text" class="form-control" id="name" name="name" value="{{ kid.name }}">
        </div>

        <div class="mb-3">
            <label for="birthday" class="form-label">Birthday</label>
            <input type="date" class="form-control" id="birthday" name="birthday"
                value="{{ kid.birthday if kid.birthday }}">
        </div>

        <div class="mb-3">
            <label for="parent_name" class="form-label">Parent Name and phone</label>
            <input type="text" class="form-control" id="parent_name" name="parent_name" value="{{ kid.parent_name }}">
        </div>

        <div class="mb-3">
            <label for="parent_last_visit" class="form-label">Parent Last Visit</label>
            <input type="date" class="form-control" id="parent_last_visit" name="parent_last_visit"
                value="{{ kid.parent_last_visit if kid.parent_last_visit }}">
        </div>

        <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="deleted" name="deleted" {% if kid.deleted %}checked{%
                endif %}>
            <label class="form-check-label" for="deleted">Deleted</label>
        </div>

        <input type="hidden" name="id" value="{{ kid.id }}">
        <input type="hidden" name="parent_id" value="{{ kid.parent_id }}">

        <button type="submit" class="btn btn-primary">Save</button>
        <a href="{{ url_for('kids_list') }}" class="btn btn-secondary">Cancel</a>
    </form>
</div>


<script>
    function updatekid() {
        document.getElementById("kid-form").submit();
    }
    // url_for use name of the function
    function cancel() {
        window.location.href = "{{ url_for('show_all_kids') }}";
    }

    function deletekid(kid_id) {
        if (
            confirm("Do you really want to delete {{ kid.kid_name }}?")
        ) {
            fetch("/kids_list/delete/" + encodeURIComponent(kid_id), {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                }
            }).then(response => {
                if (response.ok) {
                    alert("kid {{ kid.kid_name }} is deleted");
                    window.location.href = "{{ request.url_for('show_all_kids') }}";
                } else {
                    alert("Error deleting")
                }
            }).catch(err => console.error(err));
        }
    }
</script>
{% endblock %}